# 补充性规格说明

<!--- TOC --->

- [补充性规格说明](#补充性规格说明)
    - [修订历史](#修订历史)
    - [文档简介](#文档简介)
    - [功能性](#功能性)
    - [可用性](#可用性)
    - [可靠性](#可靠性)
    - [可支持性](#可支持性)
    - [实现约束](#实现约束)
    - [购买构件](#购买构件)
    - [免费开源构件](#免费开源构件)
    - [接口](#接口)
    - [应用的领域规则](#应用的领域规则)
    - [法律问题](#法律问题)
    - [所关注领域内的信息](#所关注领域内的信息)

<!--- /TOC --->


## 修订历史

|版本|日期|描述|作者|
| :--: | :--: | :--: | :--: |
|1.0|2018年6月27日|初步的草案，主要在细化阶段中进行精华|hhx|


## 文档简介

+ 本文档记录了未在用例中描述的需求和未能捕获的系统需求。这个文档和用例文档一起构成了扫码点餐系统的完整需求描述。更加完善的描述这个系统。
+ 此文档定义了扫码点餐系统的非功能需求（可靠性、可用性、性能等）和用例中通用的功能性需求。


## 功能性

>描述了用例中的通用的功能需求

+ 日志系统
    + 所有的系统出错信息必须被记录到出错日志中。信息的格式必须是系统错误号码、日期、时间、错误信息。
    + 所有的用户登陆失败的错误信息也记录在日志中，方便用户查询账户安全性。
+ 可拔插规则
    + 在几个用例的不同场景点执行任意一组规则，以支持对系统功能的定制。
+ 安全系统
    + 保证系统不被恶意攻击，包括刷订单、刷注册等恶意行为。
+ 优惠规则
    + 每个餐厅都有自己的优惠规则，有不同的折扣。
+ 预设管理员
    + 在系统之初，将预先设定一个管理员，ta具有系统所有权限。


## 可用性

+ 两个客户端
    + 一个是顾客使用的，可以注册账户、查看商家信息、评价、点菜并下单等。
    + 一个是餐厅商家使用的，可以注册账户、上传菜品信息、管理订单、修改服务状态等。
+ 系统易用性
    + 系统主要提供两方面的使用，一方面是顾客，这要扫码注册后，基本都是点击式的使用，可以便捷的选择需要的菜品即数量。另一方面是餐厅商家，除了上传菜品的文字输入以外，也都是点击式使用。总的来说，系统是便于使用上手的。
+ 快捷无错
    + 各种界面的跳转必需迅速快捷，支付时也必需快捷无措，卡顿和错误会给用户带来差的体验。
+ 帮助服务
    + 系统提供了电话服务、邮件服务。后期还会编写用户使用帮助文档，帮助用户更好的使用系统。


## 可靠性

+ 可恢复性
    + 如果在使用外部服务（支付授权、账务系统、……）时出现错误，为了完成交易，需要尝试采用本地方案（如存储和转发）加以解决。
+ 性能
    + 能够支持大量的并发连接；登录延时不超过5秒；在90%情况下，能够在1min之内完成授权。


## 可支持性

+ 可适应性
    + 扫码点餐系统在不同的餐厅不同的客户不同的场景下有其特有的业务规则和处理需求。
+ 可配置性
    + 不同的餐厅商家对扫码点餐系统有不同的界面配置需求。因此应该具有修改配置的能力，以便适应其变更业务和性能需求。

## 实现约束

+ 采用微信小程序的解决方案，后台使用go语言

## 购买构件

+ 无

## 免费开源构件

+ 服务器架构：negroni
+ URL路由和调度器：mux
+ render
+ json处理：simplejson
+ mysql、xorm

## 接口

+ 硬件接口
    + 无
+ 软件接口
    + 各种服务器和数据库访问接口


## 应用的领域规则

|ID|规则|可变性|来源|
|:--:|:--:|:--:|:--:|
|规则1|顾客折扣规则。例如：员工：20%折扣；优先顾客：10%折扣；高级顾客：25%折扣|高。每个餐馆有不同的折扣规则|零售商政策|
|规则2|产品（商品级）折扣规则。例如：宫保鸡丁本周折扣额为10%；汉堡买二送一|高。每个商家有不同的规则，每天或每小时都可能改变|零售商政策|

## 法律问题

+ 我们建议使用一些开源构件，但是要解决其许可限制的问题，以便使包含开源软件的产品能够转售。法律规定，在销售交易中必须遵从所有税务规则。同时要注意的是，这些规则可以频繁变更。


## 所关注领域内的信息

+ 定价
     + 除了在“应用的领域规则”小节中描述的定价规则之外，还需要注意，菜品有原始价格和可选的常设低标价之分。菜品标识的价格（折扣前）是常设低标价。由于账务和税务的原因，即使有常设低标价，也需要维护原始价格。

+ 信用卡支付处理
    + 当支付授权服务批准了信用卡支付后，将由支付授权服务而不是买方来负责对卖方的支付。因此对于每笔支付，卖方都需要将授权服务的未付金额记录于其应收账户下。通常，授权服务在每晚执行电子转账操作，将卖方当天的应收总额转入其账户下，同时对每笔交易扣除服务费。

+ 销售税
    + 销售税的计算可能会十分复杂，并且会根据各级政府的立法而定期变更。因此，对税金计算采用第三方软件是明智之举。税金可能分别归属于城市、地区、省和国家。

+ 食品安全
    + 餐馆的食品安全问题屡见不鲜，应该高度重视该方面，拒绝不良商家上架菜品。